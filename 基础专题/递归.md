# 递归

#### [面试题 08.06. 汉诺塔问题](https://leetcode-cn.com/problems/hanota-lcci/)

> 难度简单215
>
> 在经典汉诺塔问题中，有 3 根柱子及 N 个不同大小的穿孔圆盘，盘子可以滑入任意一根柱子。一开始，所有盘子自上而下按升序依次套在第一根柱子上(即每一个盘子只能放在更大的盘子上面)。移动圆盘时受到以下限制:
> (1) 每次只能移动一个盘子;
>(2) 盘子只能从柱子顶端滑出移到下一根柱子;
> (3) 盘子只能叠在比它大的盘子上。
>
> 请编写程序，用栈将所有盘子从第一根柱子移到最后一根柱子。
>
> 你需要原地修改栈。
>
> **示例1:**
>  
>  ```
> 输入：A = [2, 1, 0], B = [], C = []
>输出：C = [2, 1, 0]
> ```
>

##### 分析(分治)

<img src="https://raw.githubusercontent.com/LiangsLi/tuchuang/master/picgo/20230504092704.png" alt="image-20230504092657074" style="zoom:50%;" />

如上图所示, 本题要求将A柱中的`n`个有序堆叠盘子移动到C柱中, 且必须满足题目的三个条件.

这里采用分治的思想处理:

+ 当`n=1`时, 只有一个盘子, 此时直接将盘子从A柱移动到C柱即可;
+ 当`n=2`时, 此时有两个盘子, 且小盘子在大盘子上面. 此时需要借助B柱. 此时问题分解为:
  + 先将小盘子从A移动到B (数量为`1`, 基础情况, 直接移动)
  + 再将大盘子从A移动到C (数量为`1`, 基础情况, 直接移动)
  + 然后再将B中的小盘子移动到C (数量为`1`, 基础情况, 直接移动)

+ 当`n=3`时, 我们将盘子分为两部分, 一部分是最底下的大盘子(数量为`1`), 一部分是上面的两个盘子(数量为`2`), 此时问题分解为:

  + 先将`2`个较小盘子从A移动到B (数量为`2`, 需要进一步分解为3步)
  + 再将大盘子从A移动到C (数量为`1`, 基础情况, 直接移动)
  + 然后再将B中的`2`个较小盘子移动到C (数量为`2`, 需要进一步分解为3步)

  我们将上述移动分解为3个大步骤, 其中前后两步需要进一步分解. 由于任何`n>1`的情况都可以分解为多个`n=1`的移动组合, 且每次移动都可以视为从开始柱移动到目标柱, 同时还有一个辅助柱. 因此问题可以分治解决

+ 故当`n>1`时, 我们将盘子视为两部分, 一部分是最小面的大盘子, 一部分是上面的`n-1`个盘子. 此时问题变为:
  + 先将`n-1`个盘子从A移动到B  (分治解决);
  + 再将大盘子从A移动到C  (数量为`1`, 基础情况, 直接移动)
  + 再将`n-1`个盘子从B移动到C  (分治解决);

```python
def move(n: int, start: List[int], end: List[int], help: List[int]):
    """
    将start中的前n个盘子移动到end, help柱为辅助柱
    """
    if n == 1:
        # 只有一个盘子, 基础情况, 直接移动
        end.append(start.pop())
    else:
        # 需要分解问题
        # (1) 先将start中前n-1个盘子从start移动到help, 此时end作为辅助柱
        move(n-1, start, help, end)
        # (2) 再将start中最后一个盘子从start直接移动到end
        end.append(start.pop())
        # (3) 再将help中的n-1个盘子从help移动到end, 此时start作为辅助柱
        move(n-1, help, end, start)

class Solution:
    def hanota(self, A: List[int], B: List[int], C: List[int]) -> None:
        """
        Do not return anything, modify C in-place instead.
        """
        move(len(A), A, C, B)
```

时间复杂度: 从上面的分析可以看出, 当盘子数量为`n`时, 总计需要移动 $2^n-1$ 次, 故时间复杂度为 $O(2^n-1)$, 当`n`较大时, 耗时会非常久;  空间复杂度: $O(1)$
